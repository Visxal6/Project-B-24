{% extends 'app/base.html' %}
{% load static %}

{% block content %}
<div class="task-container">
    <h1 class="task-header">Daily Tasks List</h1>
    <div id="daily-countdown" class="daily-timer" aria-live="polite">--:--:--</div>
    <div class="task-summary">
        <p><strong>Your points:</strong> {{ points.score }}</p>
    </div>

    {% block styles %}
      <link rel="stylesheet" href="{% static 'leaderboard/styles/task_list.css' %}">
    {% endblock %}

    <div class="task-to-do">
        <h2 class="task-header">Tasks To Do</h2>
        {% if tasks_todo %}
            <ul>
            {% for t in tasks_todo %}
                <li class="task-item">
                    <div class="task-meta">
                        <div class="task-title">{{ t.title }}</div>
                        <div class="task-content">{{ t.content }}</div>
                    </div>
                    <div class="task-actions">
                        <div class="points-pill">{{ t.points }} pts</div>
                        <form method="post" action="{% url 'leaderboard:task_toggle' t.idx %}" style="display:inline">
                            {% csrf_token %}
                            <button class="button inline" type="submit">Mark as done</button>
                        </form>
                    </div>
                </li>
            {% endfor %}
            </ul>
        {% else %}
            <p>No tasks to do.</p>
        {% endif %}
    </div>

    <div class="task-done">
        <h2 class="task-header">Tasks Done</h2>
        {% if tasks_done %}
            <ul>
            {% for t in tasks_done %}
                <li class="task-item">
                    <div class="task-meta">
                        <div class="task-title">{{ t.title }}</div>
                        <div class="task-content">{{ t.content }}</div>
                    </div>
                    <div class="task-actions">
                        <div class="points-pill">{{ t.points }} pts</div>
                        <form method="post" action="{% url 'leaderboard:task_toggle' t.idx %}" style="display:inline">
                            {% csrf_token %}
                            <button class="button inline" type="submit">Mark as not done</button>
                        </form>
                    </div>
                </li>
            {% endfor %}
            </ul>
        {% else %}
            <p>No completed tasks yet.</p>
        {% endif %}
    </div>
</div>
<script src="{% static 'leaderboard/scripts/task_list.js' %}" defer></script>
{% endblock %}