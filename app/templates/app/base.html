{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{% block title %}Home{% endblock %}</title>

  <!-- Styles -->
  <link rel="stylesheet" href="{% static 'app/styles/base.css' %}">
  <link rel="stylesheet" href="{% static 'app/styles/general.css' %}">


  <!-- Block for styles -->
  {% block styles %}
  {% endblock %}

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
    rel="stylesheet">

  <!-- Scripts -->
  <script src="{% static 'app/scripts/base.js' %}" defer></script>
</head>

<body>

  <!-- Header -->
  <header id="header">
    <div style="display: flex; align-items: center;">
      <img id="menu-icon" src="{% static 'app/assets/icons/menu.svg' %}" alt="Menu icon">
      {% block page_title %}{% endblock %}
    </div>

    <div class="right-content-container">
      <div class="right-content">

        <!-- Inbox -->
        <div id="inbox-button">
          <a href="{% url 'social:friends' %}">
            <img src="{% static 'app/assets/icons/inbox.svg' %}" alt="Inbox icon">
            <span id="inbox-text">Inbox</span>
          </a>
        </div>

        <!-- Notifications -->
        <div id="notifications-button">
          <a href="{% url 'users:notifications' %}">
            <span class="notification-icon-wrapper">
              <img
                src="{% static 'app/assets/icons/notification.png' %}"
                alt="Notifications icon"
                class="notification-icon"
                style="width:18px; height:18px; object-fit:contain; filter: invert(1);"
              >
              {% if has_unread_notifications %}
                <span class="notification-dot"></span>
              {% endif %}
            </span>
            <span id="notifications-text">Notifications</span>
          </a>
        </div>


        <!-- Profile button (image only) -->
        <div id="profile-button">
          <img class="profile-image" src="{% static 'app/assets/icons/profile.svg' %}" alt="Profile icon">
        </div>
      </div>

      <!-- Header nav -->
      <nav id="navbar">
        <ul>
          <li>
            <a href="{% url 'profile' %}"
              class="{% if request.resolver_match.url_name == 'profile' %}active{% endif %}">

              <!--
              {% if request.user.profile_picture and request.user.profile_picture.image and request.user.profile_picture.image.name %}
              <img src="{{ request.user.profile_picture.image.url }}" alt="Profile picture" class="sidebar-pfp">
              {% else %}
              <img src="{% static 'app/assets/icons/profile.svg' %}" alt="Profile icon">
               {% endif %} 
               -->
              <img src="{% static 'app/assets/icons/profile.svg' %}" alt="Profile icon">

              <span>
                {% if request.user.first_name %}
                {{ request.user.first_name }}
                {% else %}
                Profile
                {% endif %}
              </span>
            </a>
          </li>
        </ul>

        {% if user.is_authenticated %}
        <!-- LOGOUT (form) -->
        <form method="post" action="{% url 'logout' %}"> {# or 'account_logout' (allauth) #}
          {% csrf_token %}
          <button class="button" id="logout-button" type="submit">Logout</button>
        </form>
        {% else %}
        <!-- LOGIN (link) -->
        <a class="button" id="login-button" href="{% url 'login' %}"> {# or 'account_login' (allauth) #}
          <span>Login</span>
        </a>
        {% endif %}
      </nav>
    </div>
  </header>

  <!-- Sidebar -->
  <aside id="sidebar">
    <ul class="block1">
      <li>
        <span class="logo">
          <img class="profile-image" src="{% static 'app/assets/icons/profile.svg' %}" alt="Profile icon">
        </span>
        <button id="toggle-btn">
          <img src="{% static 'app/assets/icons/double-arrow.svg' %}" alt="Menu icon">
        </button>
      </li>

      <li class="{% if request.resolver_match.url_name == 'app-home' %}active{% endif %}">
        <a href="{% url 'app-home' %}">
          <img src="{% static 'app/assets/icons/home.svg' %}" alt="Home icon">
          <span>Home</span>
        </a>
      </li>

      <li class="{% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}">
        <a href="{% url 'dashboard' %}">
          <img src="{% static 'app/assets/icons/dashboard.svg' %}" alt="Dashboard icon">
          <span>Dashboard</span>
        </a>
      </li>

      <li class="{% if request.resolver_match.namespace == 'social' %}active{% endif %}">
        <a href="{% url 'social:friends' %}">
          <img src="{% static 'app/assets/icons/social.svg' %}" alt="Social icon">
          <span>Social</span>
        </a>
      </li>

      <li>
        <button class="dropdown-btn">
          <img src="{% static 'app/assets/icons/channels.svg' %}" alt="Channels icon">
          <span>Channels</span>
          <img class="arrow-down" src="{% static 'app/assets/icons/keyboard_arrow.svg' %}" alt="Arrow Down">
        </button>
        <ul class="sub-menu">
          <div>
            <li><a href="{% url 'forum:post_list' %}">General</a></li>
            <li><a href="{% url 'forum:food_list' %}">Food</a></li>
            <li><a href="{% url 'forum:leaderboard_list' %}">Leaderboard</a></li>
            {% if user.profile.is_leader %}
            <li><a href="{% url 'forum:cio_list' %}">CIO Leaders</a></li>
            {% endif %}
          </div>
        </ul>
      </li>
    </ul>

    <ul>
      <li class="settings-button">
        <a href="#">
          <img src="{% static 'app/assets/icons/settings.svg' %}" alt="Settings icon">
          <span>Settings</span>
        </a>
      </li>

      {% if user.is_authenticated %}
      <li>
        <form method="post" action="{% url 'logout' %}"> {# or 'account_logout' #}
          {% csrf_token %}
          <button type="submit" id="logout-sidebar-button">
            <img src="{% static 'app/assets/icons/logout.svg' %}" alt="Logout icon">
            <span>Logout</span>
          </button>
        </form>
      </li>
      {% endif %}
    </ul>
  </aside>

  <!-- Main -->
  <main>
    {% block content %}
    {% endblock %}
  </main>

  {# Per-page scripts inserted here by child templates via {% block scripts %} #}
  {% block scripts %}
  {% endblock %}

</body>

</html>