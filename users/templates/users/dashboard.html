{% extends 'app/base.html' %}
{% load static %}
{% load display_name %}

{% block title %}Dashboard | CS3240 Project{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{% static 'users/styles/dashboard.css' %}">
{% endblock %}

{% block content %}
<section id="dashboard">
  <div class="dashboard-greeting">
    <h2>Welcome back, {{ request.user|get_display_name }}!</h2>
  </div>
  
  <br>
  <br>
  <div id="dashboard-container">
    <div class="dashboard-widget-container">
      <a class="dashboard-widget" href="#">
        <div class="img-container">
          <img src="../../static/users/assets/icons/score.svg" alt="score-icon">
        </div>
        <span style="color: lightgrey;">Score</span>
      </a>
      <a class="dashboard-widget" href="{% url 'leaderboard:task_list' %}">
        <div class="img-container">
          <img src="../../static/users/assets/icons/task.svg" alt="task-icon">
        </div>
        <span style="color: lightgrey;">Daily Task</span>
      </a>
      <a class="dashboard-widget" href="#">
        <div class="img-container">
          <img src="../../static/users/assets/icons/events.svg" alt="events-icon">
        </div>
        <span style="color: lightgrey;">Events</span>
      </a>
    </div>

    <div class="leaderboard-container">

      <div class="leaderboard-title">
        <img src="../../static/users/assets/icons/leaderboard.svg" alt="leaderboard-icons">
        <span>Individual Leaderboard</span>
      </div>

      <div class="leaderboard">
        <div class="row header">
          <div class="rank">Rank#</div>
          <div class="points">Points</div>
          <div class="user">User</div>
        </div>

        {% if individual_leaderboard %}
          {% for entry in individual_leaderboard %}
            <div class="row">
              <div class="rank">{{ entry.rank }}</div>
              <div class="points">{{ entry.points }}</div>
              <div class="user">{{ entry.user|get_display_name }}</div>
            </div>
          {% endfor %}
        {% else %}
          <div class="row">
            <div class="rank">—</div>
            <div class="points">0</div>
            <div class="user">No scores yet</div>
          </div>
        {% endif %}
      </div>
      
      <br>
      <br>

      <div class="leaderboard-title">
        <img src="../../static/users/assets/icons/leaderboard.svg" alt="leaderboard-icons">
        <span>CIO Leaderboard</span>
      </div>

      <div class="leaderboard">
        <div class="row header">
          <div class="rank">Rank#</div>
          <div class="points">Points</div>
          <div class="user">CIO</div>
        </div>

        {% if cio_leaderboard %}
          {% for entry in cio_leaderboard %}
            <div class="row">
              <div class="rank">{{ entry.rank }}</div>
              <div class="points">{{ entry.points }}</div>
              <div class="user">{{ entry.user|get_display_name }}</div>
            </div>
          {% endfor %}
        {% else %}
          <div class="row">
            <div class="rank">—</div>
            <div class="points">0</div>
            <div class="user">No CIO scores yet</div>
          </div>
        {% endif %}
      </div>

      {% if is_cio %}
        <br>
        <br>

        <div class="leaderboard-title">
          <img src="../../static/users/assets/icons/leaderboard.svg" alt="leaderboard-icons">
          <span>Member Leaderboard</span>
        </div>

        <div class="leaderboard">
          <div class="row header">
            <div class="rank">Rank#</div>
            <div class="points">Points</div>
            <div class="user">Member</div>
          </div>

          {% if member_leaderboard %}
            {% for entry in member_leaderboard %}
              <div class="row">
                <div class="rank">{{ entry.rank }}</div>
                <div class="points">{{ entry.points }}</div>
                <div class="user">{{ entry.user|get_display_name }}</div>
              </div>
            {% endfor %}
          {% else %}
            <div class="row">
              <div class="rank">—</div>
              <div class="points">0</div>
              <div class="user">No team members yet</div>
            </div>
          {% endif %}
        </div>
      {% endif %}

    </div>
  </div>

</section>
{% endblock %}